# Deployment Guide

> Last verified: 2025-12-09

---

## Overview

The Alawein Platform can be deployed using multiple methods. Lovable Cloud
handles backend deployment automatically.

---

## Quick Deploy

```bash
# Build for production
npm run build

# Preview locally
npm run preview
```

---

## Deployment Options

### Lovable (Primary)

Click **Publish** in Lovable interface â†’ Updates deploy automatically.

- Frontend changes require clicking "Update" in publish dialog
- Backend changes (edge functions, migrations) deploy immediately

### Vercel

```bash
npm i -g vercel
vercel deploy --prod
```

**Settings:**

- Build command: `npm run build`
- Output directory: `dist`
- Node version: 20.x

### Netlify

```bash
npm i -g netlify-cli
netlify deploy --prod --dir=dist
```

### Docker

```dockerfile
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
EXPOSE 80
```

```bash
docker build -t alawein-platform .
docker run -p 80:80 alawein-platform
```

---

## Environment Variables

Auto-configured by Lovable Cloud:

| Variable                        | Description        |
| ------------------------------- | ------------------ |
| `VITE_SUPABASE_URL`             | Backend URL        |
| `VITE_SUPABASE_PUBLISHABLE_KEY` | Public API key     |
| `VITE_SUPABASE_PROJECT_ID`      | Project identifier |

For external deployments, set these in your platform's environment
configuration.

---

## Build Output

| Setting          | Value           |
| ---------------- | --------------- |
| Output directory | `dist/`         |
| Build command    | `npm run build` |
| Install command  | `npm ci`        |
| Node version     | 20.x            |
| Framework        | Vite            |

---

## CI/CD

GitHub Actions workflow at `.github/workflows/playwright.yml`:

```yaml
# Runs on push/PR to main
- Installs dependencies
- Runs Playwright tests
- Uploads test reports
```

### Pre-deployment Checklist

- [ ] All tests pass (`npm run test`)
- [ ] E2E tests pass (`npm run test:e2e`)
- [ ] Build succeeds (`npm run build`)
- [ ] No TypeScript errors (`npx tsc --noEmit`)
- [ ] Documentation validated (`node scripts/validate-docs.js`)

---

## Troubleshooting

### Build Fails

```bash
# Check for TypeScript errors
npx tsc --noEmit

# Clear cache and rebuild
rm -rf node_modules/.vite
npm run build
```

### Environment Variables Not Working

- Ensure variables start with `VITE_` for frontend access
- Restart dev server after changes
- Check `.env` file exists (auto-generated by Lovable)

### 404 on Refresh

Configure your hosting to redirect all routes to `index.html` (SPA routing).

**Vercel**: Add `vercel.json`:

```json
{
  "rewrites": [{ "source": "/(.*)", "destination": "/index.html" }]
}
```

**Netlify**: Add `public/_redirects`:

```
/*    /index.html   200
```

---

## Related Documentation

- [ARCHITECTURE.md](../ARCHITECTURE.md) - System design
- [TESTING.md](../TESTING.md) - Testing guide
- [QUICK_START.md](../QUICK_START.md) - Local setup
